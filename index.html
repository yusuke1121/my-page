<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>My ChatGPT MultiTool å®Œå…¨çµ±åˆç‰ˆ</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #chat { border: 1px solid #ccc; padding: 10px; height: 400px; overflow-y: auto; margin-bottom: 10px; }
    .message { margin: 5px 0; }
    .user { color: blue; }
    .ai { color: green; }
    .toolbar button { margin: 5px; padding: 5px 10px; }
    .template { margin-top: 10px; }
  </style>
</head>
<body>

<h1>My ChatGPT MultiTool å®Œå…¨çµ±åˆç‰ˆ</h1>

<div id="chat"></div>

<div class="toolbar">
  <button onclick="insertTemplate('ãŠã¯ã‚ˆã†ã”ã–ã„ã¾ã™')">ğŸŒ…</button>
  <button onclick="insertTemplate('ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™')">ğŸ™</button>
  <button onclick="insertTemplate('ä»Šæ—¥ã®äºˆå®šã¯ï¼Ÿ')">ğŸ“…</button>
  <button onclick="insertTemplate('è‹±è¨³ã—ã¦')">ğŸ‡ºğŸ‡¸</button>
  <button onclick="insertTemplate('è¦ç´„ã—ã¦')">ğŸ“</button>
  <button onclick="insertTemplate('ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦')">ğŸ’»</button>
  <button onclick="insertTemplate('ãƒ—ãƒ©ãƒ³ææ¡ˆã—ã¦')">ğŸ¯</button>
</div>

<input type="text" id="userInput" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›" style="width: 80%;">
<button onclick="sendMessage()">é€ä¿¡</button>

<div class="template">
  <input type="text" id="templateName" placeholder="ãƒ†ãƒ³ãƒ—ãƒ¬å">
  <input type="text" id="templateContent" placeholder="ãƒ†ãƒ³ãƒ—ãƒ¬å†…å®¹">
  <button onclick="saveTemplate()">ï¼‹ä¿å­˜</button>
  <button onclick="deleteAllTemplates()">å…¨å‰Šé™¤</button>
</div>

<div id="templateList"></div>

<script>
// APIé€šä¿¡éƒ¨åˆ†
const apiEndpoint = "https://wispy-sea-a162.ushishibaku.workers.dev/";
const model = "gpt-4o";

async function sendMessage() {
  const input = document.getElementById("userInput");
  const message = input.value;
  if (!message) return;

  appendMessage("user", message);
  input.value = "";

  try {
    const response = await fetch(apiEndpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: model,
        messages: [{ role: "user", content: message }]
      })
    });

    if (!response.ok) {
      appendMessage("ai", "ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: " + response.status);
      return;
    }

    const data = await response.json();
    const aiReply = data.choices[0].message.content;
    appendMessage("ai", aiReply.replace(/\n/g, "<br>"));
  } catch (error) {
    appendMessage("ai", "é€šä¿¡ã‚¨ãƒ©ãƒ¼: " + error);
  }
}

function appendMessage(role, text) {
  const chat = document.getElementById("chat");
  const div = document.createElement("div");
  div.className = "message " + role;
  div.innerHTML = (role === "user" ? "ã‚ãªãŸ: " : "AI: ") + text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function insertTemplate(text) {
  document.getElementById("userInput").value = text;
}

// ãƒ†ãƒ³ãƒ—ãƒ¬ä¿å­˜ç³»
function saveTemplate() {
  const name = document.getElementById("templateName").value;
  const content = document.getElementById("templateContent").value;

  if (!name || !content) {
    alert("ãƒ†ãƒ³ãƒ—ãƒ¬åã¨å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }

  const templates = JSON.parse(localStorage.getItem("templates") || "{}");
  templates[name] = content;
  localStorage.setItem("templates", JSON.stringify(templates));

  renderTemplates();
}

function renderTemplates() {
  const templates = JSON.parse(localStorage.getItem("templates") || "{}");
  const list = document.getElementById("templateList");
  list.innerHTML = "";

  for (const name in templates) {
    const btn = document.createElement("button");
    btn.textContent = name;
    btn.onclick = () => insertTemplate(templates[name]);
    list.appendChild(btn);
  }
}

function deleteAllTemplates() {
  if (confirm("å…¨ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) {
    localStorage.removeItem("templates");
    renderTemplates();
  }
}

window.onload = renderTemplates;
</script>

</body>
</html>
